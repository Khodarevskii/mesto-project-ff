(()=>{"use strict";var e={117:(e,t,n)=>{e.exports=n.p+"6666407ac3aa5af1d5de.jpg"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var c=t[o]={exports:{}};return e[o](c,c.exports,n),c.exports}n.m=e,n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="",n.b=document.baseURI||self.location.href,n.d({},{my:()=>H,I1:()=>J,CV:()=>N,bF:()=>B,Tm:()=>R});var o=function(){return function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},r={baseUrl:"https://nomoreparties.co/v1/wff-cohort-29",headers:{authorization:"d6cf003f-e9fc-4f07-8135-f8c201818150","Content-Type":"application/json"}},c=function(){return fetch("".concat(r.baseUrl,"/users/me"),{headers:r.headers}).then(o()).catch((function(e){console.log(e)}))},a=function(e,t){return t?fetch("".concat(r.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:r.headers}).then(o()):fetch("".concat(r.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:r.headers}).then(o()).catch((function(e){console.log(e)}))},u=document.querySelector("#card-template"),i=function(e){var t;(t=e.target.closest(".card").getAttribute("id"),fetch("".concat(r.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:r.headers}).then(o()).catch((function(e){console.log(e)}))).then((function(){e.target.closest(".card").remove()}))};function s(e){e.target.classList.toggle("card__like-button_is-active");var t=e.target.closest(".card").getAttribute("id"),n=e.target.closest(".card").querySelector(".card__like-button-counter");e.target.classList.contains("card__like-button_is-active")?a(t,"true").then((function(){n.textContent++})):a(t,"false").then((function(){n.textContent--}))}function l(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",p)}function d(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",p)}n(117);var p=function(e){"Escape"===e.key&&l(document.querySelector(".popup_is-opened"))},f=document.forms["edit-profile"],_=f.elements.name,m=document.querySelector(".profile__title"),v=f.elements.description,h=document.querySelector(".profile__description"),y=document.forms["new-place"],b=y.elements["place-name"],S=y.elements.link,g=document.forms["edit-avatar"],q=g.elements.link;function E(e,t){e.value=t.textContent}function L(e,t){t.textContent=e.value}function k(e,t){t.textContent=e?"Сохранение...":"Сохраненить"}var C={},x=function(e,t){var n=Array.from(e.querySelectorAll("".concat(t.inputSelector))),o=e.querySelector("".concat(t.submitButtonSelector));n.forEach((function(t){A(e,t)})),U(n,o)},A=function(e,t){var n=e.querySelector(".".concat(t.name,"-error"));t.classList.remove("popup__input_type_error"),n.classList.remove("popup__input-error_active"),n.textContent=""},U=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.removeAttribute("disabled"),t.classList.remove("popup__button_disabled")):(t.setAttribute("disabled","true"),t.classList.add("popup__button_disabled"))};new URL(n(117),n.b);var w=document.querySelectorAll(".popup"),P=document.querySelector(".places__list"),T=document.querySelector(".popup_type_image"),O=T.querySelector(".popup__image"),j=T.querySelector(".popup__caption"),D=document.querySelector(".profile__edit-button"),B=document.querySelector(".popup_type_edit"),I=document.querySelector(".profile__add-button"),N=document.querySelector(".popup_type_new-card"),J=document.querySelector(".popup_type_edit-avatar"),H=document.querySelector(".profile__image");function R(e,t,n,o,r,c){return P.prepend(function(e,t,n,o,r,c,a,i,s){var l=u.content.querySelector(".places__item").cloneNode(!0);l.setAttribute("id","".concat(n));var d=l.querySelector(".card__image"),p=l.querySelector(".card__title"),f=l.querySelector(".card__like-button"),_=l.querySelector(".card__like-button-counter");d.src=t,d.alt=e,_.textContent=c,p.textContent=e;var m=l.querySelector(".card__delete-button");return o==r?m.addEventListener("click",a):m.remove(),f.addEventListener("click",i),d.addEventListener("click",(function(){s(e,t)})),l}(e,t,n,o,r,c,i,s,z))}function z(e,t){O.setAttribute("src",t),j.textContent=e,d(T)}!function(){C={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};var e=Array.from(document.querySelectorAll("".concat(C.formSelector)));e.forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),e.forEach((function(e){!function(e){var t=Array.from(e.querySelectorAll("".concat(C.inputSelector))),n=e.querySelector("".concat(C.submitButtonSelector));U(t,n),t.forEach((function(o){o.addEventListener("input",(function(){(function(e,t){t.validity.valid?A(e,t):function(e,t,n){var o=e.querySelector(".".concat(t.name,"-error"));t.classList.add("".concat(C.inputErrorClass)),o.textContent=n,o.classList.add("".concat(C.errorClass))}(e,t,t.validationMessage)})(e,o),U(t,n)}))}))}(e)}))}))}(),w.forEach((function(e){!function(e){e.addEventListener("click",(function(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__close"))&&l(e)}))}(e)})),Promise.all([fetch("".concat(r.baseUrl,"/cards"),{headers:r.headers}).then(o()).catch((function(e){console.log(e)})),c()]).then((function(e){e[0].forEach((function(t){return R(t.name,t.link,t._id,e[1]._id,t.owner._id,t.likes.length)}))})),c().then((function(e){m.textContent=e.name,h.textContent=e.about,H.style.backgroundImage="url(".concat(e.avatar,")")})),D.addEventListener("click",(function(){d(B),E(_,m),E(v,h),x(B,C)})),I.addEventListener("click",(function(){d(N),x(N,C)})),H.addEventListener("click",(function(){d(J),x(J,C)})),f.addEventListener("submit",(function(e){var t,n;e.preventDefault(),k(!0,B.querySelector(".popup__button")),(t=_.value,n=v.value,fetch("".concat(r.baseUrl,"/users/me"),{method:"PATCH",headers:r.headers,body:JSON.stringify({name:t,about:n})}).then(o()).catch((function(e){console.log(e)}))).then((function(){L(_,m),L(v,h),l(B)})).catch((function(e){console.log(e)})).finally((function(){k(!1,B.querySelector(".popup__button"))}))})),y.addEventListener("submit",(function(e){var t,n;e.preventDefault(),k(!0,N.querySelector(".popup__button")),(t=b.value,n=S.value,fetch("".concat(r.baseUrl,"/cards"),{method:"POST",headers:r.headers,body:JSON.stringify({name:t,link:n})}).then(o()).catch((function(e){console.log(e)}))).then((function(e){R(e.name,e.link,e._id,e.owner._id,e.owner._id),l(N),y.reset()})).catch((function(e){console.log(e)})).finally((function(){k(!1,N.querySelector(".popup__button"))}))})),g.addEventListener("submit",(function(e){var t;e.preventDefault(),k(!0,J.querySelector(".popup__button")),(t=q.value,fetch("".concat(r.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:r.headers,body:JSON.stringify({avatar:t})}).then(o()).catch((function(e){console.log(e)}))).then((function(e){H.style.backgroundImage="url(".concat(e.avatar,")"),g.reset(),l(J)})).catch((function(e){console.log(e)})).finally((function(){k(!1,J.querySelector(".popup__button"))}))}))})();