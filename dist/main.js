(()=>{"use strict";var e={117:(e,t,n)=>{e.exports=n.p+"6666407ac3aa5af1d5de.jpg"}},t={};function n(o){var c=t[o];if(void 0!==c)return c.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.m=e,n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.p="",n.b=document.baseURI||self.location.href,n.d({},{my:()=>J,I1:()=>N,CV:()=>I,bF:()=>B,Tm:()=>M});var o=function(){return function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},c={baseUrl:"https://nomoreparties.co/v1/wff-cohort-29",headers:{authorization:"d6cf003f-e9fc-4f07-8135-f8c201818150","Content-Type":"application/json"}},r=function(e,t){return t?fetch("".concat(c.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:c.headers}).then(o()).catch((function(e){console.log(e)})):fetch("".concat(c.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:c.headers}).then(o()).catch((function(e){console.log(e)}))},a=document.querySelector("#card-template"),u=function(e){var t;(t=e.target.closest(".card").getAttribute("id"),fetch("".concat(c.baseUrl,"/cards/").concat(t),{method:"DELETE",headers:c.headers}).then(o()).catch((function(e){console.log(e)}))).then((function(){e.target.closest(".card").remove()}))};function i(e){e.target.classList.toggle("card__like-button_is-active");var t=e.target.closest(".card").getAttribute("id"),n=e.target.closest(".card").querySelector(".card__like-button-counter");e.target.classList.contains("card__like-button_is-active")?r(t,"true").then((function(){n.textContent++})):r(t,"false").then((function(){n.textContent--}))}function s(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",d)}function l(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",d)}n(117);var d=function(e){"Escape"===e.key&&s(document.querySelector(".popup_is-opened"))},p=document.forms["edit-profile"],f=p.elements.name,m=document.querySelector(".profile__title"),_=p.elements.description,v=document.querySelector(".profile__description"),h=document.forms["new-place"],y=h.elements["place-name"],b=h.elements.link,S=document.forms["edit-avatar"],g=S.elements.link;function q(e,t){e.value=t.textContent}function E(e,t){t.textContent=e.value}function L(e,t){t.textContent=e?"Сохранение...":"Сохранить"}var C={},k=function(e,t){var n=Array.from(e.querySelectorAll("".concat(t.inputSelector))),o=e.querySelector("".concat(t.submitButtonSelector));n.forEach((function(t){x(e,t)})),A(n,o)},x=function(e,t){var n=e.querySelector(".".concat(t.name,"-error"));t.classList.remove("".concat(C.inputErrorClass)),n.classList.remove("".concat(C.inputErrorClass)),n.textContent=""},A=function(e,t){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.removeAttribute("disabled"),t.classList.remove("".concat(C.inactiveButtonClass))):(t.setAttribute("disabled","true"),t.classList.add("".concat(C.inactiveButtonClass)))};new URL(n(117),n.b);var U=document.querySelectorAll(".popup"),w=document.querySelector(".places__list"),P=document.querySelector(".popup_type_image"),T=P.querySelector(".popup__image"),O=P.querySelector(".popup__caption"),j=document.querySelector(".profile__edit-button"),B=document.querySelector(".popup_type_edit"),D=document.querySelector(".profile__add-button"),I=document.querySelector(".popup_type_new-card"),N=document.querySelector(".popup_type_edit-avatar"),J=document.querySelector(".profile__image");function M(e,t,n,o,c,r){return w.prepend(function(e,t,n,o,c,r,u,i,s){var l=a.content.querySelector(".places__item").cloneNode(!0);l.setAttribute("id","".concat(n));var d=l.querySelector(".card__image"),p=l.querySelector(".card__title"),f=l.querySelector(".card__like-button"),m=l.querySelector(".card__like-button-counter");d.src=t,d.alt=e,m.textContent=r,p.textContent=e;var _=l.querySelector(".card__delete-button");return o==c?_.addEventListener("click",u):_.remove(),f.addEventListener("click",i),d.addEventListener("click",(function(){s(e,t)})),l}(e,t,n,o,c,r,u,i,V))}function V(e,t){T.setAttribute("src",t),O.textContent=e,l(P)}!function(){C={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};var e=Array.from(document.querySelectorAll("".concat(C.formSelector)));e.forEach((function(t){t.addEventListener("submit",(function(e){e.preventDefault()})),e.forEach((function(e){!function(e){var t=Array.from(e.querySelectorAll("".concat(C.inputSelector))),n=e.querySelector("".concat(C.submitButtonSelector));A(t,n),t.forEach((function(o){o.addEventListener("input",(function(){(function(e,t){t.validity.valid?x(e,t):function(e,t,n){var o=e.querySelector(".".concat(t.name,"-error"));t.classList.add("".concat(C.inputErrorClass)),o.textContent=n,o.classList.add("".concat(C.errorClass))}(e,t,t.validationMessage),t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity("")})(e,o),A(t,n)}))}))}(e)}))}))}(),U.forEach((function(e){!function(e){e.addEventListener("click",(function(t){(t.target.classList.contains("popup")||t.target.classList.contains("popup__close"))&&s(e)}))}(e)})),Promise.all([fetch("".concat(c.baseUrl,"/cards"),{headers:c.headers}).then(o()).catch((function(e){console.log(e)})),fetch("".concat(c.baseUrl,"/users/me"),{headers:c.headers}).then(o()).catch((function(e){console.log(e)}))]).then((function(e){e[0].forEach((function(t){M(t.name,t.link,t._id,e[1]._id,t.owner._id,t.likes.length),m.textContent=e[1].name,v.textContent=e[1].about,J.style.backgroundImage="url(".concat(e[1].avatar,")")}))})),j.addEventListener("click",(function(){l(B),q(f,m),q(_,v),k(B,C)})),D.addEventListener("click",(function(){l(I),k(I,C)})),J.addEventListener("click",(function(){l(N),k(N,C)})),p.addEventListener("submit",(function(e){var t,n;e.preventDefault(),L(!0,B.querySelector(".popup__button")),(t=f.value,n=_.value,fetch("".concat(c.baseUrl,"/users/me"),{method:"PATCH",headers:c.headers,body:JSON.stringify({name:t,about:n})}).then(o()).catch((function(e){console.log(e)}))).then((function(){E(f,m),E(_,v),s(B)})).catch((function(e){console.log(e)})).finally((function(){L(!1,B.querySelector(".popup__button"))}))})),h.addEventListener("submit",(function(e){var t,n;e.preventDefault(),L(!0,I.querySelector(".popup__button")),(t=y.value,n=b.value,fetch("".concat(c.baseUrl,"/cards"),{method:"POST",headers:c.headers,body:JSON.stringify({name:t,link:n})}).then(o()).catch((function(e){console.log(e)}))).then((function(e){M(e.name,e.link,e._id,e.owner._id,e.owner._id),s(I),h.reset()})).catch((function(e){console.log(e)})).finally((function(){L(!1,I.querySelector(".popup__button"))}))})),S.addEventListener("submit",(function(e){var t;e.preventDefault(),L(!0,N.querySelector(".popup__button")),(t=g.value,fetch("".concat(c.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:c.headers,body:JSON.stringify({avatar:t})}).then(o()).catch((function(e){console.log(e)}))).then((function(e){J.style.backgroundImage="url(".concat(e.avatar,")"),S.reset(),s(N)})).catch((function(e){console.log(e)})).finally((function(){L(!1,N.querySelector(".popup__button"))}))}))})();